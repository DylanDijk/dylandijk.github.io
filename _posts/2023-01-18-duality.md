---
layout: post
title: Duality
date: 2023-01-18 11:30 +0000
categories: [Maths, Optimisation]
tags: [Optimisation]
math: true
---

# Duality

In this document I give the main results for duality in standard optimisation problems.

## Standard form

$$
\begin{align*}
\text{minimize} \quad & f_0(x) \\
\text{subject to} \quad & f_i(x) \leq 0, \quad i = 1, 2, \ldots, m \\
& h_j(x) = 0, \quad j = 1, 2, \ldots, p \\
\end{align*}
$$

An optimisation problem is convex if $f_0, f_1, \ldots, f_m$ are convex, and $h_1, h_2, \ldots, h_p$ are affine functions. I will not  assume the problem is convex, unless stated otherwise.

For rest of this post, I will just have inequality constraints, that is $p = 0$.

Let $p^*$ denote the optimal value of the problem.

## Lagrangian

The idea of the lagrangian is to incoroporate the constraints into the objective function. For a standard form optimisation problem, we have the following definitions:

**Lagrangian**:

$$
\mathcal{L}(x, \lambda) = f_0(x) + \sum_{i=1}^m \lambda_i f_i(x)
$$

**Lagrangian dual function**:

$$
g(\lambda) = \inf_x \mathcal{L}(x, \lambda)
$$

Since the dual function is the pointwise infimum of a family of affine functions of $(\lambda,\nu)$, it is concave, even if the original problem is not convex.

The lagrangian dual provides a lower bound for the optimal value.
$$\forall \lambda \geq 0 \quad g(\lambda) \leq p^*$$

If the lagrangian has no lower bound, then $g(\lambda) = -\infty$. Values of $\lambda$ for which $\lambda \geq 0$ and $g(\lambda) \in \mathbb{R}$ are called *dual feasible*. 

## Lagrange dual problem

Now that the langrangian dual function, provides a lower bound for the optimal value, when $\lambda \geq 0$. We can try to find the tightest lower bound, by maximising the dual function. This gives us the lagrangian dual problem:

$$
\begin{align*}
\text{maximize} \quad & g(\lambda) \\
\text{subject to} \quad & \lambda \geq 0
\end{align*}
$$

Let $d^*$ denote the optimal value of the dual problem. An immediate inequality by construction is the weak duality property:

 $$d^* \leq p^*$$

 It now makes sense why points where $\lambda \geq 0$ and $g(\lambda) > -\infty$ are called *dual feasible*. If there were no feasible points for the dual problem, then $d^* = -\infty$. Using standard convention that the maximum of the empty set is $-\infty$.

 Strong duality holds if $d^* = p^*$. 

 ## KKT conditions

If we assume strong duality holds and we have primal and dual optimal points $x^*$ and $\lambda^*$, respectively (no convex assumption). Then we can write the following: 

$$
\begin{align}
f_0(x^*) &= g(\lambda^*) \nonumber\\
&= \inf_x \mathcal{L}(x, \lambda^*) \nonumber\\
&= \inf_x \left( f_0(x) + \sum_{i=1}^m \lambda_i^* f_i(x) \right) \\
&\leq f_0(x^*) + \sum_{i=1}^m \lambda_i^* f_i(x^*) \nonumber\\
&\leq f_0(x^*) \nonumber
\end{align}
$$

Therefore, as the inequalities are sandwiched, all the inequalities are equalities. This implies:

- $f_0(x^*) = g(\lambda^*) = \mathcal{L}(x^*, \lambda^*)$   
That is, $x^*$ minimises $\mathcal{L}(x, \lambda^*)$ over $x$.

- $\sum_{i=1}^m \lambda_i^* f_i(x^*) = 0 \implies \lambda_i^* f_i(x^*) = 0, \quad i = 1, 2, \ldots, m \quad$ (complementary slackness)


### Necessary

If we have the additional assumption that all of the functions in the problem are differentiable. We have the following **KKT conditions**:

$$
\begin{align*}
\nabla_x \mathcal{L}(x^*, \lambda^*) &= 0 \\
\lambda_i^* f_i(x^*) &= 0, \quad i = 1, 2, \ldots, m \\
\lambda_i^* &\geq 0, \quad i = 1, 2, \ldots, m
\end{align*}
$$

In particular, for any optimisation problem with differentiable functions, any pair of primal and dual optimal points $x^*$ and $\lambda^*$ satisfy the KKT conditions above.


 